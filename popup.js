(()=>{const e=Alert2(()=>document.body),t=Confirm2(()=>document.body),n=async()=>{document.getElementById("loggedOutView").classList.remove("hidden"),document.getElementById("loggedInView").classList.add("hidden");{const e=864e5;let t;{let e=Date.now();const{test:n}=await chrome.storage.local.get("test");n&&(data=JSON.parse(atob(n)),e=parseInt(data.time)),t=e+trialDuration}const n=Math.ceil((t-Date.now())/e);document.getElementById("trialDays").textContent=n>0?lang(`${n}day`)||n:lang("trialExpired")}document.getElementById("upgradeBtn")?.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"payment-page"}),setTimeout(()=>{window.close()},100)}),document.getElementById("loginBtn")?.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"login-page"}),setTimeout(()=>{window.close()},100)})};document.addEventListener("DOMContentLoaded",()=>{translate(document),chrome.runtime.sendMessage({type:"getLoginInfo"}).then(d=>{d?(async()=>{const{loginInfo:d}=await chrome.storage.local.get("loginInfo");if(!d||!d.email)return;document.getElementById("loggedInView").classList.remove("hidden"),document.getElementById("loggedOutView").classList.add("hidden"),document.getElementById("userEmail").textContent=d.email;const i=document.querySelector(".devices-list");chrome.runtime.sendMessage({type:"devices"},e=>{e&&0!==e.length?e.forEach(({id:e,name:t,time:n,isSelf:d})=>{let a=document.createElement("div");a.innerHTML=`\n                                <div class="device-item">\n                                        <div class="device-header">\n                                                <span class="device-icon">üíª</span>\n                                                <span>${t} <span data-i18n="current" style="display:${d?"":"none"};    font-weight: bolder; color: var(--primary-dark);">(Áï∂Ââç)</span></span>\n                                        </div>\n                                        <div class="device-actions">\n                                                <button class="logout-device-btn" data-i18n="logoutDevice" device-id="${e}">ÈÄÄÂá∫Ê≠§Ë®≠ÂÇô</button>\n                                        </div>\n                                        <div class="device-time" >\n                                                <span data-i18n="loginTime">ÁôªÈåÑÊôÇÈñì: </span>\n                                                <span>${new Date(n).toLocaleString()}</span>\n                                        </div>\n                                </div>`,a=a.firstElementChild,translate(a),i.appendChild(a)}):chrome.runtime.sendMessage({type:"getLoginInfo"}).then(e=>{e||n()}).catch(n)}),document.getElementById("logoutBtn")?.addEventListener("click",async()=>{await t(lang("exitBeforePrompt"))&&chrome.runtime.sendMessage({type:"logout",data:{deviceId:void 0}},e=>{e&&n()})}),i.addEventListener("click",async d=>{const i=d.target;if(!i.hasAttribute("device-id"))return;const a=i.closest(".device-item");if(a.classList.add("delete"),!await t(lang("exitBrowserBeforePrompt")))return void a.classList.remove("delete");const s=i.getAttribute("device-id");chrome.runtime.sendMessage({type:"logout",data:{deviceId:s}},({success:t,logouted:d})=>{t?(a.remove(),d?n():e(1,lang("browserExitPrompt"))):a.classList.remove("delete")})})})():n()}).catch(n)})})();